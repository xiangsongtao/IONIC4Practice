"use strict";function _storageProvider(e){return function(){var r="ngStorage-";this.setKeyPrefix=function(t){if("string"!=typeof t)throw new TypeError("[ngStorage] - "+e+"Provider.setKeyPrefix() expects a String.");r=t};var t=angular.toJson,n=angular.fromJson;this.setSerializer=function(r){if("function"!=typeof r)throw new TypeError("[ngStorage] - "+e+"Provider.setSerializer expects a function.");t=r},this.setDeserializer=function(r){if("function"!=typeof r)throw new TypeError("[ngStorage] - "+e+"Provider.setDeserializer expects a function.");n=r},this.get=function(t){return n(window[e].getItem(r+t))},this.set=function(n,o){return window[e].setItem(r+n,t(o))},this.$get=["$rootScope","$window","$log","$timeout","$document",function(o,a,i,s,u){function c(e){var r;try{r=a[e]}catch(t){r=!1}if(r&&"localStorage"===e){var n="__"+Math.round(1e7*Math.random());try{localStorage.setItem(n,n),localStorage.removeItem(n)}catch(t){r=!1}}return r}var l,g,f=r.length,d=c(e)||(i.warn("This browser does not support Web Storage!"),{setItem:angular.noop,getItem:angular.noop,removeItem:angular.noop}),p={$default:function(e){for(var r in e)angular.isDefined(p[r])||(p[r]=angular.copy(e[r]));return p.$sync(),p},$reset:function(e){for(var t in p)"$"===t[0]||delete p[t]&&d.removeItem(r+t);return p.$default(e)},$sync:function(){for(var e,t=0,o=d.length;o>t;t++)(e=d.key(t))&&r===e.slice(0,f)&&(p[e.slice(f)]=n(d.getItem(e)))},$apply:function(){var e;if(g=null,!angular.equals(p,l)){e=angular.copy(l),angular.forEach(p,function(n,o){angular.isDefined(n)&&"$"!==o[0]&&(d.setItem(r+o,t(n)),delete e[o])});for(var n in e)d.removeItem(r+n);l=angular.copy(p)}}};return p.$sync(),l=angular.copy(p),o.$watch(function(){g||(g=s(p.$apply,100,!1))}),a.addEventListener&&a.addEventListener("storage",function(e){if(e.key){var t=u[0];t.hasFocus&&t.hasFocus()||r!==e.key.slice(0,f)||(e.newValue?p[e.key.slice(f)]=n(e.newValue):delete p[e.key.slice(f)],l=angular.copy(p),o.$apply())}}),a.addEventListener&&a.addEventListener("beforeunload",function(){p.$apply()}),p}]}}angular.module("ngStorage",[]).provider("$localStorage",_storageProvider("localStorage")).provider("$sessionStorage",_storageProvider("sessionStorage"));